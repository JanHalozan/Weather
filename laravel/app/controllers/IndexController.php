<?php/** * Created by PhpStorm. * User: janhalozan * Date: 4/15/14 * Time: 2:37 PM * * Route: / * Model: <none - yet> * * */class IndexController extends BaseController {    //This is the default action    public function index()     {        //Get the user location        $place = 'Maribor';        //Populate our view with data for the current city        $view = View::make('index');        // TEMPERATURE        $record = CurrentWeather::first()->temperature;        $view->temperature = round($record);        // FACT        try        {            $randomFact = rand(0, 127);            $lastFactId = Facts::orderBy('id', 'desc')->first()->id;            $view->fact = Facts::find($lastFactId - $randomFact)->fact;        }        catch (Exception $e)        {            $view->fact = "That our random fact feature is not working.";        }                // GEOIP        //get user ip        //$ip = $_SERVER['REMOTE_ADDR'];        //send request to freegeoip.net        $url = "https://freegeoip.net/xml/93.103.179.172";        //$url = "freegeoip.net/xml/".$ip;        $ch = curl_init();        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);        curl_setopt($ch, CURLOPT_HEADER, false);        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_REFERER, $url);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);        $result = curl_exec($ch);        curl_close($ch);        //var_dump($result);        $dom = new DOMDocument;        $dom->loadXML($result);        //not 100% brilliant solution if you ask me... but it works        $Latititude;        $Latitudenode = $dom->getElementsByTagName('Latitude');        //at the end its only 1 element...        foreach($Latitudenode as $Lat)        {            $latitude = $Lat->nodeValue;            //print $Lat->nodeValue."\n";        }        $Longitude;        $Longitudenode = $dom->getElementsByTagName('Longitude');        //at the end its only 1 element...        foreach($Longitudenode as $Long)        {            $Longitude = $Long->nodeValue;            //print $Long->nodeValue;        }          return $view;    }}